<?xml version="1.0"?>
<facility name="socket">
  <description>The socket facility contains events related to sockets</description>

  <event name="call">
    <description>Generic socket call : FIXME : should be more detailed.</description>
    <field name="call_number"> <description>Number of socket call</description> <int size="4"/> </field>
    <field name="first_argument"> <description>First argument of socket call</description> <ulong/> </field>
  </event>

  <event name="create">
    <description>Create a socket</description>
    <field name="socket"> <description>Socket structure address</description> <pointer/> </field>
    <field name="family"> <description>Socket family</description> <int size="4"/> </field>
    <field name="type"> <description>Socket type</description> <int size="4"/> </field>
    <field name="protocol"> <description>Socket protocol</description> <int size="4"/> </field>
    <field name="fd"> <description>Socket file descriptor</description> <int size="4"/> </field>
  </event>

  <event name="sendmsg">
    <description>Sending a socket message</description>
    <field name="socket"> <description>Socket structure address</description> <pointer/> </field>
    <field name="family"> <description>Socket family</description> <int size="4"/> </field>
    <field name="type"> <description>Socket type</description> <int size="4"/> </field>
    <field name="protocol"> <description>Socket protocol</description> <int size="4"/> </field>
    <field name="size"> <description>Size of the message</description> <size_t/> </field>
  </event>

  <event name="recvmsg">
    <description>Receiving a socket message</description>
    <field name="socket"> <description>Socket structure address</description> <pointer/> </field>
    <field name="family"> <description>Socket family</description> <int size="4"/> </field>
    <field name="type"> <description>Socket type</description> <int size="4"/> </field>
    <field name="protocol"> <description>Socket protocol</description> <int size="4"/> </field>
    <field name="size"> <description>Size of the message</description> <size_t/> </field>
  </event>

</facility>

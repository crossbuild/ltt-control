<?xml version="1.0"?>
<facility name="net">
	<description>The network facility contains events related to low level network operations</description>

	<event name="socket_sendmsg">
		<description>Sending a socket message</description>
		<field name="socket">
			<description>Socket structure address</description>
			<pointer/>
		</field>
		<field name="family">
			<description>Socket family</description>
			<int/>
		</field>
		<field name="type">
			<description>Socket type</description>
			<int/>
		</field>
		<field name="protocol">
			<description>Socket protocol</description>
			<int/>
		</field>
		<field name="size">
			<description>Size of the message</description>
			<size_t/>
		</field>
	</event>

	<event name="socket_recvmsg">
		<description>Receiving a socket message</description>
		<field name="socket">
			<description>Socket structure address</description>
			<pointer/>
		</field>
		<field name="family">
			<description>Socket family</description>
			<int/>
		</field>
		<field name="type">
			<description>Socket type</description>
			<int/>
		</field>
		<field name="protocol">
			<description>Socket protocol</description>
			<int/>
		</field>
		<field name="size">
			<description>Size of the message</description>
			<size_t/>
		</field>
	</event>

	<event name="socket_create">
		<description>Create a socket</description>
		<field name="socket">
			<description>Socket structure address</description>
			<pointer/>
		</field>
		<field name="family">
			<description>Socket family</description>
			<int/>
		</field>
		<field name="type">
			<description>Socket type</description>
			<int/>
		</field>
		<field name="protocol">
			<description>Socket protocol</description>
			<int/>
		</field>
		<field name="fd">
			<description>Socket file descriptor</description>
			<int/>
		</field>
	</event>

	<event name="socket_call">
		<description>Generic socket call : FIXME : should be more detailed.</description>
		<field name="call_number">
			<description>Number of socket call</description>
			<int/>
		</field>
		<field name="first_argument">
			<description>First argument of socket call</description>
			<ulong/>
		</field>
	</event>


	<event name="dev_xmit">
		<description>We send a packet</description>
		<field name="skbuff"><description>Socket buffer pointer : identify the socket buffer</description>
			<pointer/>
		</field>
		<field name="protocol">
			<description>Protocol of the packet</description>
			<uint_fixed size="2" byte_order="network"/>
		</field>
	</event>

	<event name="dev_receive">
		<description>A packet is arriving</description>
		<field name="skbuff">
			<description>Socket buffer pointer : identify the socket buffer</description>
			<pointer/>
		</field>
		<field name="protocol">
			<description>Protocol of the packet</description>
			<uint_fixed size="2" byte_order="network"/>
		</field>
	</event>

	<event name="insert_ifa">
		<description>IP interface up</description>
			<field name="name">
				<description>Interface name</description>
				<string/>
			</field>
			<field name="addr">
				<description>IP address</description>
				<uint_fixed size="4" byte_order="network"/>
			</field>
	</event>

	<event name="del_ifa">
		<description>IP interface down</description>
			<field name="name">
				<description>Interface name</description>
				<string/>
			</field>
	</event>
</facility>
